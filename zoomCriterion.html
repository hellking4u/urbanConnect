<html>

<body>

    <script src="https://js.leapmotion.com/leap-0.6.4.js"></script>

    <div id="stage" style="background-color:rgb(191,191,191); width:800; height:600">

    </div>
    <div id="debug-box" style="background-color: #f2f2f2;width: 200;height: 200;position: absolute;left: 808;top: 200;">-41,128,201</div>
    <script>
        const debugBox = document.getElementById("debug-box");

        const vPlaneZ = -40;
        const screenZ = -120;
        function transformCoordToZoomIndex(tipPos, scaleDelta = 0.5) {

            // check if x and y are close enough
            const x = tipPos[0];
            const y = tipPos[1];
            const z = tipPos[2];

            if (x < -45 || x > 40 || y < 240 || y > 310)
                return 1;
            if (z > vPlaneZ || z < screenZ)
                return 1;

            return 1 + ((z - vPlaneZ) / (screenZ - vPlaneZ)) * scaleDelta
        }
        // function
        Leap.loop(function (frame) {
            console.log(frame.hands.length);

            if (frame.hands.length > 0) {
                debugBox.innerHTML = "";
                const finger = frame.hands[0].indexFinger;
                debugBox.innerHTML += finger.tipPosition.map(val => Math.round(val));
                debugBox.innerHTML += '<br />';
                var rect = debugBox.getBoundingClientRect();
                debugBox.innerHTML += `Box pos : ${Math.round(rect.top)}, ${Math.round(rect.right)}, ${Math.round(rect.bottom)}, ${Math.round(rect.left)}`;
                debugBox.innerHTML += '<br />';
                const zoomFactor = transformCoordToZoomIndex(finger.tipPosition);

                debugBox.innerHTML += `zoom factor ${zoomFactor}`;
                debugBox.style.transform = `scale(${zoomFactor},${zoomFactor})`
            }

            // console.log(frame.hands[0].fingers);
        });
    </script>
    <link href="/style.css">
</body>

</html>